<?xml version="1.0"?>
<!-- Local launch file to start up the simulation environment and visualization -->
<launch>
  <arg name="robot_ns"/>                          <!-- Namespace for the robot -->
  <arg name="gui" default="true"/>                <!-- Flag to (de)activate the visualization using RViz and Gazebo -->
  <arg name="worldtype" default="$(find aerial_robot_simulation)/gazebo_model/world/empty.world"/>    <!-- Set world environment in for Gazebo visualization -->
  <arg name="spawn_x" default="0.0"/>             <!-- Spawn point in Gazebo -->
  <arg name="spawn_y" default="0.0"/>             <!-- Spawn point in Gazebo -->
  <arg name="spawn_z" default="0.0"/>             <!-- Spawn point in Gazebo -->
  <arg name="spawn_yaw" default="0.0"/>           <!-- Spawn point in Gazebo -->
  <arg name="rviz_config"/>                       <!-- Configuration file for RViz -->
  <arg name="rviz_init_pose"/>                    <!-- Initiale pose of the robot in RViz -->

  <!-- Launch Gazebo environment -->
  <include file="$(find gazebo_ros)/launch/empty_world.launch">
    <arg name="gui" value="$(arg gui)"/>
    <arg name="world_name" value="$(arg worldtype)"/>
    <arg name="use_sim_time" value="true"/>
    <arg name="paused" value="false"/>
    <arg name="debug" value="false"/>
  </include>
  <node name="$(anon urdf_spawner)" pkg="gazebo_ros" type="spawn_model" respawn="false" output="screen"
        args="-urdf -model $(arg robot_ns) -x $(arg spawn_x) -y $(arg spawn_y) -z $(arg spawn_z) -Y $(arg spawn_yaw) -param $(arg robot_ns)/robot_description">
  </node>

  <!-- Initialize Node for RViz -->
  <group ns="$(arg robot_ns)">
    <rosparam file ="$(arg rviz_init_pose)" command="load"/>
    <node name="$(anon rviz)" pkg="rviz" type="rviz" args="-d $(arg rviz_config)" respawn="true" if="$(arg gui)"/>
  </group>

  <!-- Load basic simulation parameter --> <!-- TODO move to global launch files? -->
  <rosparam file="$(find aerial_robot_simulation)/config/Simulation.yaml" command="load" ns="$(arg robot_ns)"/>
  
  <!-- Initialize Node for controller -->
  <node name="controller_spawner" pkg="controller_manager" type="spawner" respawn="false"
        output="screen" ns="$(arg robot_ns)" args="joint_state_controller attitude_controller">
  </node>
</launch>
